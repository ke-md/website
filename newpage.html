<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Top 5 Modern Lightbox Gallery Designs</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Lora:wght@400;600&family=Montserrat:wght@500;700&family=Poppins:wght@500;600&family=Roboto:wght@700&display=swap" rel="stylesheet">
    <style>
        /* Developer Comment: General body styling */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5;
        }

        /* --- General Lightbox Styles --- */
        /* Developer Comment: Base styles for all lightbox backdrops. Handles positioning, visibility, and transitions. */
        .lightbox-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 50;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.4s ease, visibility 0.4s ease;
        }

        .lightbox-backdrop.active {
            opacity: 1;
            visibility: visible;
        }

        /* Developer Comment: Styling for the close button, consistent across all lightboxes. */
        .lightbox-close {
            position: absolute;
            top: 1.5rem;
            right: 1.5rem;
            width: 2.5rem;
            height: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 9999px;
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.2s ease;
            z-index: 10;
        }

        .lightbox-close:hover {
            background-color: rgba(0, 0, 0, 0.6);
            transform: scale(1.1);
        }
        
        /* Developer Comment: Styling for navigation arrows, consistent across all lightboxes. */
        .lightbox-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 3rem;
            height: 3rem;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 9999px;
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.2s ease;
            z-index: 10;
        }

        .lightbox-nav:hover {
            background-color: rgba(0, 0, 0, 0.6);
            transform: scale(1.1);
        }
        
        /* Developer Comment: Hover effect for gallery thumbnail images. */
        .gallery-item img {
            transition: transform 0.3s ease-out, box-shadow 0.3s ease-out;
            cursor: pointer;
        }
        
        .gallery-item:hover img {
            transform: scale(1.05);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1), 0 6px 6px rgba(0,0,0,0.1);
        }

        /* Developer Comment: Ensures that in a staggered/masonry layout, all items align to the top of their grid cell. */
        #cinematic-gallery, #minimalist-gallery, #split-gallery, #immersive-gallery {
            align-items: start; 
        }

        /* --- 1. Cinematic Fade --- */
        /* Developer Comment: Dark, blurred backdrop for the cinematic effect. */
        #cinematic-backdrop {
            background-color: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(8px);
        }

        /* Developer Comment: Animation for the image container - scales in for a zoom effect. */
        #cinematic-content {
            position: relative;
            transform: scale(0.95);
            transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            max-width: 90vw;
            max-height: 90vh;
        }

        #cinematic-backdrop.active #cinematic-content {
            transform: scale(1);
        }
        
        /* Developer Comment: Animation for the caption - slides up from the bottom. */
        #cinematic-caption {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            background: linear-gradient(to top, rgba(0, 0, 0, 0.7), transparent);
            color: white;
            padding: 3rem 1.5rem 1.5rem;
            transform: translateY(100%);
            transition: transform 0.4s ease 0.2s;
        }
        
        #cinematic-backdrop.active #cinematic-caption {
            transform: translateY(0);
        }

        /* --- 2. Minimalist Slide-In --- */
        #minimalist-backdrop {
            background-color: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(4px);
        }

        /* Developer Comment: Animation for the image container - slides in from the right. */
        #minimalist-image-container {
            transform: translateX(100%);
            opacity: 0;
            transition: transform 0.5s cubic-bezier(0.645, 0.045, 0.355, 1), opacity 0.4s ease;
            box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25);
        }
        #minimalist-backdrop.active #minimalist-image-container {
            transform: translateX(0);
            opacity: 1;
        }
        #minimalist-close {
            background-color: rgba(255, 255, 255, 0.7);
        }
        #minimalist-title { font-family: 'Poppins', sans-serif; }
        #minimalist-caption {
            background: linear-gradient(to top, rgba(255, 255, 255, 0.8), transparent);
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.4s ease 0.2s, transform 0.4s ease 0.2s;
        }
        #minimalist-backdrop.active #minimalist-caption {
            opacity: 1;
            transform: translateY(0);
        }

        /* --- 3. Interactive Grid (JS-driven, no separate lightbox) --- */
        #interactive-grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            perspective: 1000px;
            align-items: start;
        }
        .interactive-item {
            position: relative;
            overflow: hidden;
            border-radius: 0.5rem;
            transition: transform 0.5s ease, z-index 0.5s ease, filter 0.5s ease;
            z-index: 1;
            cursor: pointer;
        }
        .interactive-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        /* Developer Comment: Styles for the 'active' grid item. It breaks out of the grid flow using 'position: fixed' and scales up. */
        .interactive-item.active {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(2.5) !important;
            max-width: 90vw;
            max-height: 90vh;
            width: auto;
            height: auto;
            z-index: 100;
            box-shadow: 0 0 0 100vmax rgba(0,0,0,0.7);
            filter: brightness(1) !important;
            cursor: default;
        }
         /* Developer Comment: When one item is active, the others scale down and blur. */
         #interactive-grid-container.active .interactive-item:not(.active) {
            transform: scale(0.9);
            filter: blur(5px) brightness(0.7);
        }
        .interactive-caption {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            padding: 1.5rem;
            color: white;
            background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
            text-align: center;
            opacity: 0;
            transform: translateY(100%);
            transition: opacity 0.3s ease, transform 0.3s ease;
        }
        .interactive-item.active .interactive-caption {
            opacity: 1;
            transform: translateY(0);
            transition-delay: 0.3s;
        }
        .interactive-caption h3 { font-family: 'Montserrat', sans-serif; }
        .interactive-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            width: 2.5rem;
            height: 2.5rem;
            background-color: rgba(0, 0, 0, 0.4);
            color: white;
            border-radius: 9999px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 110;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease 0.3s, visibility 0.3s ease 0.3s, transform 0.2s ease;
        }
        .interactive-item.active .interactive-close {
            opacity: 1;
            visibility: visible;
        }
        .interactive-close:hover {
            transform: scale(1.1);
            background-color: rgba(0,0,0,0.7);
        }


        /* --- 4. Split Screen --- */
        #split-backdrop {
            background-color: #1a1a1a;
        }
        
        #split-content {
            display: flex;
            flex-direction: row; /* Default to row for desktop */
            width: 90vw;
            height: 90vh;
            max-width: 1400px;
            background-color: #262626;
            border-radius: 0.5rem;
            overflow: hidden;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.4s ease, transform 0.4s ease;
        }

        #split-backdrop.active #split-content {
            opacity: 1;
            transform: translateY(0);
        }
        
        .split-image-panel {
            flex: 3;
            background-color: #111;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        
        .split-info-panel {
            flex: 2;
            padding: 2.5rem;
            color: #e5e5e5;
            overflow-y: auto;
        }
        #split-description, .split-info-panel ul { font-family: 'Lora', serif; }
        
        /* Developer Comment: Media query to stack the split-screen layout on smaller screens. */
        @media (max-width: 1024px) {
            #split-content { flex-direction: column; } /* Switch to column on smaller screens */
            .split-image-panel { flex: 1; }
            .split-info-panel { flex: 1; }
        }

        /* --- 5. Full Screen Immersive --- */
        #immersive-backdrop {
            background-color: #000;
        }

        #immersive-content {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        #immersive-image {
            max-width: 100%;
            max-height: 100%;
            transform: scale(0.8);
            opacity: 0;
            transition: transform 0.6s cubic-bezier(0.165, 0.84, 0.44, 1), opacity 0.5s ease;
        }

        #immersive-backdrop.active #immersive-image {
            transform: scale(1);
            opacity: 1;
        }

        #immersive-ui {
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        /* Developer Comment: UI controls appear on hover (desktop) or when a specific class is added via JS (touch devices). */
        #immersive-backdrop:hover #immersive-ui, #immersive-backdrop.touch-active #immersive-ui {
             opacity: 1;
        }
        #immersive-title { font-family: 'Roboto', sans-serif; letter-spacing: 0.05em; }

    </style>
</head>
<body class="text-gray-800">

    <header class="bg-white shadow-md sticky top-0 z-40">
        <div class="container mx-auto px-6 py-4">
            <h1 class="text-3xl font-bold text-gray-900">Modern Lightbox Galleries</h1>
            <p class="text-lg text-gray-600">5 unique designs for showcasing images.</p>
        </div>
    </header>

    <main class="container mx-auto px-6 py-12">
        
        <!-- Gallery Section Template -->
        <section class="mb-16">
            <div class="mb-6">
                <h2 class="text-2xl font-semibold mb-1">1. Cinematic Fade & Zoom</h2>
                <p class="text-gray-500">A dramatic entrance. The background blurs as the image fades in with a subtle zoom. Captions slide up for context.</p>
            </div>
            <div id="cinematic-gallery" class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <!-- Gallery items will be injected here by JavaScript -->
            </div>
        </section>

        <section class="mb-16">
            <div class="mb-6">
                <h2 class="text-2xl font-semibold mb-1">2. Minimalist Slide-In</h2>
                <p class="text-gray-500">Clean and elegant. The image smoothly slides in from the side over a blurred background for a modern, app-like feel.</p>
            </div>
            <div id="minimalist-gallery" class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <!-- Gallery items will be injected here by JavaScript -->
            </div>
        </section>
        
        <section class="mb-16">
            <div class="mb-6">
                <h2 class="text-2xl font-semibold mb-1">3. Interactive Grid</h2>
                <p class="text-gray-500">Maintains context by expanding the image in place, pushing other items away. Click an image to see it in action.</p>
            </div>
            <div id="interactive-grid-container">
                <!-- Gallery items will be injected here by JavaScript -->
            </div>
        </section>
        
        <section class="mb-16">
            <div class="mb-6">
                <h2 class="text-2xl font-semibold mb-1">4. Split-Screen Panel</h2>
                <p class="text-gray-500">Perfect for portfolios or product showcases. Displays the image alongside detailed information.</p>
            </div>
            <div id="split-gallery" class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <!-- Gallery items will be injected here by JavaScript -->
            </div>
        </section>
        
        <section>
            <div class="mb-6">
                <h2 class="text-2xl font-semibold mb-1">5. Full-Screen Immersive</h2>
                <p class="text-gray-500">Maximizes focus on the image. The UI fades away, creating an distraction-free, cinematic viewing experience.</p>
            </div>
            <div id="immersive-gallery" class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <!-- Gallery items will be injected here by JavaScript -->
            </div>
        </section>

    </main>
    
    <!-- Lightbox Structures -->
    <!-- Developer Comment: These are the hidden HTML structures for each lightbox type. JavaScript will populate them with data and make them visible. -->

    <!-- 1. Cinematic Fade Lightbox -->
    <div id="cinematic-backdrop" class="lightbox-backdrop">
        <div id="cinematic-content" class="relative overflow-hidden rounded-lg">
            <img id="cinematic-image" src="" alt="Cinematic View" class="block max-w-full max-h-full object-contain">
            <div id="cinematic-caption" class="text-white">
                <h3 id="cinematic-title" class="text-xl font-bold"></h3>
                <p id="cinematic-description" class="text-sm opacity-80"></p>
            </div>
        </div>
        <div id="cinematic-close" class="lightbox-close">
             <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
        </div>
        <div id="cinematic-prev" class="lightbox-nav left-4">
            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
        </div>
        <div id="cinematic-next" class="lightbox-nav right-4">
            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
        </div>
    </div>

    <!-- 2. Minimalist Slide-In Lightbox -->
    <div id="minimalist-backdrop" class="lightbox-backdrop">
        <div id="minimalist-image-container" class="relative overflow-hidden rounded-lg">
            <img id="minimalist-image" src="" alt="Minimalist View" class="block object-contain max-w-[90vw] max-h-[90vh]">
            <div id="minimalist-caption" class="absolute bottom-0 left-0 w-full p-6 text-gray-800">
                <h3 id="minimalist-title" class="text-xl font-semibold"></h3>
            </div>
        </div>
        <div id="minimalist-close" class="lightbox-close top-4 right-4 text-gray-800">
             <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
        </div>
        <div id="minimalist-prev" class="lightbox-nav left-4 text-gray-800 bg-white/70">
            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
        </div>
        <div id="minimalist-next" class="lightbox-nav right-4 text-gray-800 bg-white/70">
            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
        </div>
    </div>
    
    <!-- 4. Split Screen Lightbox -->
    <div id="split-backdrop" class="lightbox-backdrop p-4 md:p-8">
        <div id="split-content">
            <div class="split-image-panel">
                <img id="split-image" src="" alt="Split Screen View" class="w-full h-full object-contain p-2">
            </div>
            <div class="split-info-panel">
                <h3 id="split-title" class="text-3xl font-bold mb-4"></h3>
                <p id="split-description" class="text-base mb-6 leading-relaxed"></p>
                <div class="border-t border-gray-600 pt-6">
                    <h4 class="text-lg font-semibold mb-3">Details</h4>
                    <ul class="text-sm space-y-2">
                         <li><strong>Photographer:</strong> <span id="split-author"></span></li>
                         <li><strong>Location:</strong> <span id="split-location"></span></li>
                         <li><strong>Date:</strong> <span id="split-date"></span></li>
                    </ul>
                </div>
            </div>
        </div>
        <div id="split-close" class="lightbox-close">
             <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
        </div>
        <div id="split-prev" class="lightbox-nav left-8">
            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
        </div>
        <div id="split-next" class="lightbox-nav right-8">
            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
        </div>
    </div>

    <!-- 5. Full Screen Immersive Lightbox -->
    <div id="immersive-backdrop" class="lightbox-backdrop">
        <div id="immersive-content">
             <img id="immersive-image" src="" alt="Immersive View" class="object-contain">
        </div>
        <div id="immersive-ui">
             <div id="immersive-caption" class="absolute bottom-8 left-1/2 -translate-x-1/2 text-white text-center">
                <h3 id="immersive-title" class="text-lg font-bold"></h3>
            </div>
            <div id="immersive-close" class="lightbox-close">
                 <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
            </div>
            <div id="immersive-prev" class="lightbox-nav left-8">
                <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
            </div>
            <div id="immersive-next" class="lightbox-nav right-8">
                <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
            </div>
        </div>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // Developer Comment: This array holds all the data for the images. 
            // Using a single source of truth makes the gallery easy to update.
            const imageData = [
                { id: 1, src: 'https://picsum.photos/seed/mountain/600/900', title: 'Mountain Vista', description: 'A stunning view of snow-capped mountains under a clear blue sky.', author: 'Jane Doe', location: 'Alps, Switzerland', date: '2023-08-15' },
                { id: 2, src: 'https://picsum.photos/seed/lake/900/600', title: 'Serene Lake', description: 'A calm lake reflecting the surrounding forest and mountains.', author: 'John Smith', location: 'Lake Louise, Canada', date: '2023-07-22' },
                { id: 3, src: 'https://picsum.photos/seed/hills/700/1000', title: 'Rolling Hills', description: 'Lush green hills stretching out under a dramatic, cloudy sky.', author: 'Sarah Green', location: 'Tuscany, Italy', date: '2023-05-18' },
                { id: 4, src: 'https://picsum.photos/seed/city/800/800', title: 'City at Night', description: 'An aerial view of a bustling city skyline at night.', author: 'Emily White', location: 'Tokyo, Japan', date: '2023-09-01' },
                { id: 5, src: 'https://picsum.photos/seed/cabin/1000/700', title: 'Cozy Cabin', description: 'A secluded cabin in the woods, nestled by a calm lake.', author: 'Michael Brown', location: 'Ontario, Canada', date: '2023-06-10' },
                { id: 6, src: 'https://picsum.photos/seed/beach/750/750', title: 'Beach Paradise', description: 'Crystal clear water and a pristine white sand beach.', author: 'David Wilson', location: 'Maldives', date: '2023-04-25' },
                { id: 7, src: 'https://picsum.photos/seed/forest/650/850', title: 'Misty Forest', description: 'Sunlight filtering through the trees in a misty, enchanted forest.', author: 'James Harris', location: 'Black Forest, Germany', date: '2023-02-12' },
                { id: 8, src: 'https://picsum.photos/seed/pier/850/650', title: 'Wooden Pier', description: 'A long wooden pier stretching out into a calm, blue lake.', author: 'Olivia Taylor', location: 'Bavaria, Germany', date: '2023-03-30' },
            ];
            
            const galleries = ['cinematic', 'minimalist', 'split', 'immersive'];
            const interactiveGridContainer = document.getElementById('interactive-grid-container');

            // Developer Comment: Dynamically populates all gallery containers from the imageData array.
            imageData.forEach((imgData, index) => {
                // HTML for standard grid items
                const galleryItemHTML = `
                    <div class="gallery-item rounded-lg overflow-hidden" data-index="${index}">
                        <img src="${imgData.src}" alt="${imgData.title}" class="w-full h-full object-cover" onerror="this.onerror=null;this.src='https://placehold.co/800x800/374151/9ca3af?text=Error';">
                    </div>`;

                galleries.forEach(galleryId => {
                    document.getElementById(`${galleryId}-gallery`)?.insertAdjacentHTML('beforeend', galleryItemHTML);
                });

                // HTML for the special interactive grid items
                const interactiveItemHTML = `
                    <div class="interactive-item" data-index="${index}">
                        <img src="${imgData.src}" alt="${imgData.title}" class="w-full h-full object-cover" onerror="this.onerror=null;this.src='https://placehold.co/800x800/374151/9ca3af?text=Error';">
                        <div class="interactive-caption">
                            <h3 class="text-2xl font-bold mb-2">${imgData.title}</h3>
                            <p class="text-sm opacity-90">${imgData.description}</p>
                        </div>
                         <div class="interactive-close">
                             <svg class="w-6 h-6 pointer-events-none" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                        </div>
                    </div>`;
                interactiveGridContainer.insertAdjacentHTML('beforeend', interactiveItemHTML);
            });


            // --- General Lightbox Logic ---
            // Developer Comment: Global state variables for tracking the current image and gallery.
            let currentIndex = 0;
            let currentGallery = [];
            let touchStartX = 0;
            const SWIPE_THRESHOLD = 50; // Min pixels to be considered a swipe

            // Developer Comment: Records the starting X position of a touch event for swipe detection.
            function handleTouchStart(e) {
                touchStartX = e.changedTouches[0].screenX;
            }

            // Developer Comment: Calculates the difference between touch start and end to determine if a swipe occurred.
            function handleTouchEnd(e) {
                if (e.target.closest('.lightbox-nav') || e.target.closest('.lightbox-close')) return;
                const touchEndX = e.changedTouches[0].screenX;
                if (touchEndX < touchStartX - SWIPE_THRESHOLD) {
                    showImage(currentIndex + 1); // Swiped left
                }
                if (touchEndX > touchStartX + SWIPE_THRESHOLD) {
                    showImage(currentIndex - 1); // Swiped right
                }
            }

            // Developer Comment: Core function to open any lightbox. It handles body overflow, runs the specific setup function, and adds event listeners.
            function openLightbox(backdrop, contentSetupFn) {
                document.body.style.overflow = 'hidden';
                contentSetupFn();
                backdrop.classList.add('active');
                window.addEventListener('keydown', handleKeydown);
                // Add swipe listeners only if the lightbox has navigation arrows
                if (backdrop.querySelector('.lightbox-nav')) {
                    backdrop.addEventListener('touchstart', handleTouchStart, { passive: true });
                    backdrop.addEventListener('touchend', handleTouchEnd, { passive: true });
                }
            }
            
            // Developer Comment: Core function to close any lightbox. Reverses the actions of openLightbox.
            function closeLightbox(backdrop) {
                document.body.style.overflow = '';
                backdrop.classList.remove('active');
                window.removeEventListener('keydown', handleKeydown);
                backdrop.removeEventListener('touchstart', handleTouchStart);
                backdrop.removeEventListener('touchend', handleTouchEnd);
                if (backdrop.id === 'immersive-backdrop') {
                    backdrop.classList.remove('touch-active');
                }
            }

            // Developer Comment: Navigates to a new image. The modulo operator (%) ensures the index wraps around, creating an infinite loop.
            function showImage(index) {
                currentIndex = (index + currentGallery.length) % currentGallery.length;
                const activeLightboxId = document.querySelector('.lightbox-backdrop.active')?.id;
                if (!activeLightboxId) return;

                // Re-run the setup function for the currently active lightbox with the new image index.
                const setupFn = lightboxRegistry[activeLightboxId.replace('-backdrop', '')].setup;
                setupFn();
            }

            // Developer Comment: Handles global keyboard events (Escape, Arrow Keys) for navigation and closing.
            function handleKeydown(e) {
                const activeInteractive = document.querySelector('.interactive-item.active');
                if (e.key === 'Escape') {
                    const activeLightbox = document.querySelector('.lightbox-backdrop.active');
                    if (activeLightbox) {
                         const closeBtn = activeLightbox.querySelector('[id$="-close"]');
                         closeBtn.click();
                    } else if (activeInteractive) {
                        const closeBtn = activeInteractive.querySelector('.interactive-close');
                        closeBtn.click();
                    }
                } else if (e.key === 'ArrowRight' && !activeInteractive) {
                    showImage(currentIndex + 1);
                } else if (e.key === 'ArrowLeft' && !activeInteractive) {
                    showImage(currentIndex - 1);
                }
            }


            // --- Lightbox Registry ---
            // Developer Comment: An object that holds the configuration for each lightbox type.
            // This pattern makes the code organized and easy to extend with new lightbox styles.
            // 'backdrop': A reference to the main HTML element.
            // 'setup': A function that populates the lightbox with the correct image data.
            // 'init': A function that sets up the initial event listeners for the gallery thumbnails and lightbox controls.
            const lightboxRegistry = {
                'cinematic': {
                    backdrop: document.getElementById('cinematic-backdrop'),
                    setup: () => {
                        const data = currentGallery[currentIndex];
                        document.getElementById('cinematic-image').src = data.src;
                        document.getElementById('cinematic-title').textContent = data.title;
                        document.getElementById('cinematic-description').textContent = data.description;
                    },
                    init: () => {
                        document.getElementById('cinematic-gallery').addEventListener('click', (e) => {
                           const item = e.target.closest('.gallery-item');
                           if(item) {
                               currentIndex = parseInt(item.dataset.index);
                               currentGallery = imageData;
                               openLightbox(lightboxRegistry.cinematic.backdrop, lightboxRegistry.cinematic.setup);
                           }
                        });
                        document.getElementById('cinematic-close').addEventListener('click', () => closeLightbox(lightboxRegistry.cinematic.backdrop));
                        document.getElementById('cinematic-prev').addEventListener('click', () => showImage(currentIndex - 1));
                        document.getElementById('cinematic-next').addEventListener('click', () => showImage(currentIndex + 1));
                    }
                },
                'minimalist': {
                    backdrop: document.getElementById('minimalist-backdrop'),
                    setup: () => {
                        const data = currentGallery[currentIndex];
                        document.getElementById('minimalist-image').src = data.src;
                        document.getElementById('minimalist-title').textContent = data.title;
                    },
                    init: () => {
                         document.getElementById('minimalist-gallery').addEventListener('click', (e) => {
                           const item = e.target.closest('.gallery-item');
                           if(item) {
                               currentIndex = parseInt(item.dataset.index);
                               currentGallery = imageData;
                               openLightbox(lightboxRegistry.minimalist.backdrop, lightboxRegistry.minimalist.setup);
                           }
                        });
                        document.getElementById('minimalist-close').addEventListener('click', () => closeLightbox(lightboxRegistry.minimalist.backdrop));
                        document.getElementById('minimalist-prev').addEventListener('click', () => showImage(currentIndex - 1));
                        document.getElementById('minimalist-next').addEventListener('click', () => showImage(currentIndex + 1));
                    }
                },
                'split': {
                    backdrop: document.getElementById('split-backdrop'),
                    setup: () => {
                        const data = currentGallery[currentIndex];
                        document.getElementById('split-image').src = data.src;
                        document.getElementById('split-title').textContent = data.title;
                        document.getElementById('split-description').textContent = data.description;
                        document.getElementById('split-author').textContent = data.author;
                        document.getElementById('split-location').textContent = data.location;
                        document.getElementById('split-date').textContent = data.date;
                    },
                    init: () => {
                         document.getElementById('split-gallery').addEventListener('click', (e) => {
                           const item = e.target.closest('.gallery-item');
                           if(item) {
                               currentIndex = parseInt(item.dataset.index);
                               currentGallery = imageData;
                               openLightbox(lightboxRegistry.split.backdrop, lightboxRegistry.split.setup);
                           }
                        });
                        document.getElementById('split-close').addEventListener('click', () => closeLightbox(lightboxRegistry.split.backdrop));
                        document.getElementById('split-prev').addEventListener('click', () => showImage(currentIndex - 1));
                        document.getElementById('split-next').addEventListener('click', () => showImage(currentIndex + 1));
                    }
                },
                'immersive': {
                    backdrop: document.getElementById('immersive-backdrop'),
                    setup: () => {
                        const data = currentGallery[currentIndex];
                        document.getElementById('immersive-image').src = data.src;
                        document.getElementById('immersive-title').textContent = data.title;
                    },
                    init: () => {
                         document.getElementById('immersive-gallery').addEventListener('click', (e) => {
                           const item = e.target.closest('.gallery-item');
                           if(item) {
                               currentIndex = parseInt(item.dataset.index);
                               currentGallery = imageData;
                               openLightbox(lightboxRegistry.immersive.backdrop, lightboxRegistry.immersive.setup);
                           }
                        });
                        document.getElementById('immersive-close').addEventListener('click', () => closeLightbox(lightboxRegistry.immersive.backdrop));
                        document.getElementById('immersive-prev').addEventListener('click', () => showImage(currentIndex - 1));
                        document.getElementById('immersive-next').addEventListener('click', () => showImage(currentIndex + 1));
                    }
                }
            };
            
            // Developer Comment: Loop through the registry and call the init function for each lightbox to attach its event listeners.
            Object.values(lightboxRegistry).forEach(lb => lb.init());

            // --- Immersive UI Touch Logic ---
            // Developer Comment: Toggles a class on tap for mobile devices to show/hide the UI, simulating a hover effect.
            document.getElementById('immersive-backdrop').addEventListener('click', (e) => {
                if (!e.target.closest('#immersive-ui')) {
                    document.getElementById('immersive-backdrop').classList.toggle('touch-active');
                }
            });

            // --- 3. Interactive Grid Logic ---
            // Developer Comment: This logic is separate as the interactive grid doesn't use the standard lightbox backdrop.
            const gridItems = document.querySelectorAll('.interactive-item');

            function closeInteractiveGridItem(item) {
                item.classList.remove('active');
                interactiveGridContainer.classList.remove('active');
                document.body.style.overflow = '';
                window.removeEventListener('keydown', handleKeydown);
            }
            
            gridItems.forEach(item => {
                const closeBtn = item.querySelector('.interactive-close');

                // Listener for the dedicated close button.
                closeBtn.addEventListener('click', (e) => {
                    e.stopPropagation(); // Prevents the item's own click listener from firing.
                    closeInteractiveGridItem(item);
                });

                // Listener for the grid item itself.
                item.addEventListener('click', (e) => {
                    if (e.target.closest('.interactive-close')) return;
                    if (item.classList.contains('active')) return; 
                    if (document.querySelector('.lightbox-backdrop.active') || document.querySelector('.interactive-item.active')) return;
                    
                    gridItems.forEach(i => i.classList.remove('active')); // Deactivate any other active item.
                    item.classList.add('active');
                    interactiveGridContainer.classList.add('active');
                    document.body.style.overflow = 'hidden';
                    window.addEventListener('keydown', handleKeydown);
                });
            });

        });
    </script>

</body>
</html>

